(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{119:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n.n(c),s=(n(90),n(91),n(154)),i=n(11),u=n(14),l=Object(u.b)("contacts/changeFilter"),d=(Object(u.b)("contacts/AddContactRequest"),Object(u.b)("contacts/addContactSuccess"),Object(u.b)("contacts/addContactError"),Object(u.b)("contacts/deleteContactRequest"),Object(u.b)("contacts/deleteContactSuccess"),Object(u.b)("contacts/deleteContactError"),n(2));function b(){var e=Object(s.a)(),t=Object(i.c)();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("label",{htmlFor:e,children:"   "}),Object(d.jsx)("input",{id:e,type:"text",onChange:function(e){t(l(e.target.value))}})]})}var j=n(36),m=n(37),p=n.n(m),O=n(54),h=n(24),f=n.n(h);f.a.defaults.baseURL="https://connections-api.herokuapp.com";var x=Object(u.c)("contacts/fetchContacts",function(){var e=Object(O.a)(p.a.mark((function e(t,n){var a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.rejectWithValue,e.prev=1,e.next=4,f.a.get("/contacts");case 4:return r=e.sent,e.abrupt("return",r.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),v=Object(u.c)("contacts/addContact",function(){var e=Object(O.a)(p.a.mark((function e(t,n){var a,r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,r=t.number,c=n.rejectWithValue,e.prev=2,e.next=5,f.a.post("/contacts",{name:a,number:r});case 5:return o=e.sent,e.abrupt("return",o.data);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",c(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),g=Object(u.c)("contacts/deleteContact",function(){var e=Object(O.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.rejectWithValue,e.prev=1,e.next=4,f.a.delete("contacts/".concat(t));case 4:return e.sent,e.abrupt("return",t);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}());var w=Object(i.b)(null,(function(e){return{onSubmit:function(t){return e(v(t))}}}))((function(e){var t=e.onSubmit,n=Object(a.useState)(""),r=Object(j.a)(n,2),c=r[0],o=r[1],s=Object(a.useState)(""),i=Object(j.a)(s,2),u=i[0],l=i[1];return Object(d.jsxs)("form",{type:"submit",onSubmit:function(e){e.preventDefault(),t({name:c,number:u}),o(""),l("")},children:[Object(d.jsxs)("label",{children:["Name",Object(d.jsx)("input",{value:c,type:"text",name:"name",pattern:"^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",title:"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0431\u0443\u043a\u0432, \u0430\u043f\u043e\u0441\u0442\u0440\u043e\u0444\u0430, \u0442\u0438\u0440\u0435 \u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u0432. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan \u0438 \u0442. \u043f.",required:!0,onChange:function(e){return o(e.currentTarget.value)}})]}),Object(d.jsxs)("label",{children:["Number",Object(d.jsx)("input",{value:u,type:"tel",name:"number",pattern:"\\+?\\d{1,4}?[-.\\s]?\\(?\\d{1,3}?\\)?[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,9}",title:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0446\u0438\u0444\u0440 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b, \u0442\u0438\u0440\u0435, \u043a\u0440\u0443\u0433\u043b\u044b\u0435 \u0441\u043a\u043e\u0431\u043a\u0438 \u0438 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0441 +",required:!0,onChange:function(e){return l(e.currentTarget.value)}})]}),Object(d.jsx)("button",{type:"submit",children:"Add contact"})]})})),y=n(38),k=function(e){return e.user.token},C=Object(y.a)([function(e){return e.filter},function(e){return e.contacts.entities}],(function(e,t){if(e){var n=e.toLowerCase();return t.filter((function(e){return e.name.toLowerCase().includes(n)}))}return t}));var S=Object(i.b)(null,(function(e){return{onClick:function(t){return e(g(t))}}}))((function(e){var t=e.onClick,n=Object(i.c)();Object(a.useEffect)((function(){n(x())}),[n]);var r=Object(i.d)(C);return Object(d.jsx)("ul",{children:r.length>0&&r.map((function(e){var n=e.id,a=e.name,r=e.number;return Object(d.jsxs)("li",{children:[a," ",r,Object(d.jsx)("button",{type:"button",id:n,onClick:function(e){return t(e.target.id)},children:"delete"})]},n)}))})}));function P(e){var t=e.type,n=e.onClick,a=e.buttonName,r=e.disabled;return Object(d.jsx)("button",{type:t,className:r,onClick:n,disabled:r,children:a})}var A=n(26),B="https://connections-api.herokuapp.com",W=Object(u.e)({name:"user",initialState:{name:"",email:"",token:"",error:""},reducers:{registerSuccess:function(e,t){e.name=t.payload.name,e.email=t.payload.email,e.token=t.payload.token},registerFailure:function(e,t){e.error=t.payload.error},loginSuccess:function(e,t){e.name=t.payload.name,e.email=t.payload.email,e.token=t.payload.token},loginFailure:function(e,t){e.error=t.payload.error},logoutSuccess:function(e,t){e.user="",e.email="",e.token="",e.error=""},logoutFailure:function(e,t){}}}),R=W.actions,E=R.registerSuccess,T=R.registerFailure,F=R.loginSuccess,q=R.loginFailure,L=R.logoutSuccess,z=R.logoutFailure,I=W.reducer,N=function(e){f.a.defaults.headers.common.Authorization="Bearer ".concat(e)},Z=function(){f.a.defaults.headers.common.Authorization=""};function U(){var e=Object(i.c)();return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)("h3",{children:"Phonebook"}),Object(d.jsx)(w,{}),Object(d.jsx)(P,{onClick:function(){var t;e((function(e){return e({type:"LOGOUT_REQUEST"}),f.a.post("".concat(B,"/users/logout"),t).then((function(t){e(L(t.data)),Z()})).catch((function(t){e(z({error:t.toString()}))}))}))},buttonName:"Logout"}),Object(d.jsx)("h3",{children:"Contacts"}),Object(d.jsx)("p",{children:"filter via name"}),Object(d.jsx)(b,{}),Object(d.jsx)(S,{})]})}var V="/",_="/registration",G="/login",H=n(46),J=n(29),Q=n(153),$=n(152),D={name:"",email:"",passwrod:"",confirmPassword:""},M=function(){var e=Object(i.c)(),t=Object(a.useState)(!1),n=Object(j.a)(t,2),r=n[0],c=n[1],o=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]),s=Object(a.useCallback)((function(e){var t={};return e.name?e.name.length<2&&(t.name="Invalid name\ud83d\ude22"):t.name="Required\ud83e\uddd0",e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address\ud83d\ude22"):t.email="Required\ud83e\uddd0",e.password?(e.password.length<7||e.password.length>15)&&(t.password="Invalid value, password should have  7-15 symbols\ud83d\ude09"):t.password="Required\ud83e\uddd0",e.confirmPassword?e.confirmPassword.length<7||e.confirmPassword.length>15?t.confirmPassword="Invalid value, password should have  7-15 symbols\ud83d\ude09":e.confirmPassword!==e.password&&(t.confirmPassword="Passwords do not match\ud83d\ude22"):t.confirmPassword="Required\ud83e\uddd0",t}),[]),u=Object(a.useCallback)((function(t,n){var a,r=n.setSubmitting,c=t.name,o=t.email,s=t.password;e((a={name:c,email:o,password:s},function(e){return e({type:"REGISTER_REQUEST"}),f.a.post("".concat(B,"/users/signup"),Object(A.a)({},a)).then((function(t){var n=t.data,a=n.user,r=a.name,c=a.email,o=n.token;N(o),e(E({name:r,email:c,token:o}))})).catch((function(t){e(T({error:t.toString()}))}))})),r(!1)}),[e]);return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Registration Form"}),Object(d.jsx)(H.b,{initialValues:D,validate:s,onSubmit:u,children:function(e){var t=e.isSubmitting,n=e.errors,a=e.touched,c=e.handleChange,s=e.handleBlur,i=e.values;return Object(d.jsxs)(H.a,{children:[Object(d.jsx)($.a,{style:{maxWidth:"350px"},fullWidth:!0,id:"name",name:"name",label:"Name",type:"name",value:i.name,onChange:c,onBlur:s,error:a.name&&Boolean(n.name),helperText:a.name&&n.name}),Object(d.jsx)("br",{}),Object(d.jsx)($.a,{style:{maxWidth:"350px"},fullWidth:!0,id:"email",name:"email",label:"Email",type:"email",value:i.email,onChange:c,onBlur:s,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(d.jsx)("br",{}),Object(d.jsx)($.a,{style:{maxWidth:"350px"},fullWidth:!0,id:"password",name:"password",label:"Password",type:r?"text":"password",value:i.password,onChange:c,onBlur:s,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)($.a,{style:{maxWidth:"350px"},fullWidth:!0,maxWidth:"50px",id:"password",name:"confirmPassword",label:"Confirm Password",type:r?"text":"password",value:i.confirmPassword,onChange:c,onBlur:s,error:a.confirmPassword&&Boolean(n.confirmPassword),helperText:a.confirmPassword&&n.confirmPassword}),Object(d.jsx)(Q.a,{color:"success",size:"small",onClick:o,children:r?"Hide password":"Show password"}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)(Q.a,{color:"primary",variant:"contained",type:"submit",disabled:t||!(Object.keys(a).length===Object.keys(D).length&&0===Object.keys(n).length),children:"Submit"})]})}}),Object(d.jsx)(J.b,{to:G,children:"Have an account? Login here!"})]})},K={email:"",password:""},X=function(){var e=Object(i.c)(),t=Object(a.useState)(!1),n=Object(j.a)(t,2),r=n[0],c=n[1],o=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]),s=Object(a.useCallback)((function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address\ud83d\ude22"):t.email="Required\ud83e\uddd0",e.password?(e.password.length<7||e.password.length>15)&&(t.password="Invalid value, password should have  7-15 symbols\ud83d\ude09"):t.password="Required\ud83e\uddd0",t}),[]),u=Object(a.useCallback)((function(t,n){var a,r=n.setSubmitting,c=t.email,o=t.password;e((a={email:c,password:o},function(e){return e({type:"LOGIN_REQUEST"}),f.a.post("".concat(B,"/users/login"),Object(A.a)({},a)).then((function(t){var n=t.data,a=n.user,r=a.name,c=a.email,o=n.token;e(F({name:r,email:c,token:o})),N(t.data.token),console.log(f.a.defaults.headers.common.Authorization)})).catch((function(t){e(q({error:t.toString()}))}))})),r(!1)}),[e]);return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Login Form"}),Object(d.jsx)(H.b,{initialValues:K,validate:s,onSubmit:u,children:function(e){var t=e.values,n=e.errors,a=e.touched,c=e.handleChange,s=e.handleBlur,i=e.handleSubmit,u=e.isSubmitting;return Object(d.jsxs)("form",{onSubmit:i,children:[Object(d.jsx)($.a,{fullWidth:!0,style:{maxWidth:"350px"},id:"email",name:"email",label:"Email",type:"email",value:t.email,onChange:c,onBlur:s,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(d.jsx)("br",{}),Object(d.jsx)($.a,{fullWidth:!0,style:{maxWidth:"350px"},id:"login",name:"password",label:"Password",type:r?"text":"password",value:t.password,onChange:c,onBlur:s,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(d.jsx)(Q.a,{color:"success",size:"small",onClick:o,children:r?"Hide password":"Show password"}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)(Q.a,{color:"primary",variant:"contained",type:"submit",disabled:u||!(Object.keys(a).length===Object.keys(K).length&&0===Object.keys(n).length),children:"Submit"})]})}}),Object(d.jsx)("br",{}),Object(d.jsx)(J.b,{to:_,children:"Do not have account? Register here!"})]})},Y=n(13),ee=n(53),te=["component"],ne=function(e){var t=e.component,n=Object(ee.a)(e,te),a=Object(i.d)(k);return Object(d.jsx)(Y.b,Object(A.a)(Object(A.a)({},n),{},{render:function(e){return a?Object(d.jsx)(t,Object(A.a)({},e)):Object(d.jsx)(Y.a,{to:_})}}))},ae=["component"],re=function(e){var t=e.component,n=Object(ee.a)(e,ae),a=Object(i.d)(k);return Object(d.jsx)(Y.b,Object(A.a)(Object(A.a)({},n),{},{render:function(e){return a?Object(d.jsx)(Y.a,{to:V}):Object(d.jsx)(t,Object(A.a)({},e))}}))},ce=n(151);function oe(){return Object(d.jsx)(a.Suspense,{fallback:Object(d.jsx)("div",{children:"Loading..."}),children:Object(d.jsx)(Y.d,{children:Object(d.jsxs)(ce.a,{maxWidth:"sm",className:"Container",children:[Object(d.jsx)(ne,{component:U,path:V,exact:!0}),Object(d.jsx)(re,{path:_,exact:!0,component:M}),Object(d.jsx)(re,{path:G,exact:!0,component:X})]})})})}var se,ie,ue,le=n(20),de=n(78),be=n(18),je=Object(u.d)([],(se={},Object(le.a)(se,x.fulfilled,(function(e,t){return t.payload})),Object(le.a)(se,v.fulfilled,(function(e,t){var n=t.payload;return[].concat(Object(de.a)(e),[n])})),Object(le.a)(se,g.fulfilled,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),se)),me=Object(u.d)(!1,(ie={},Object(le.a)(ie,x.pending,(function(){return!0})),Object(le.a)(ie,x.fulfilled,(function(){return!1})),Object(le.a)(ie,x.rejected,(function(){return!1})),Object(le.a)(ie,v.pending,(function(){return!0})),Object(le.a)(ie,v.fulfilled,(function(){return!1})),Object(le.a)(ie,v.rejected,(function(){return!1})),ie)),pe=Object(u.d)(null,(ue={},Object(le.a)(ue,x.rejected,(function(e,t){return t.payload})),Object(le.a)(ue,x.pending,(function(){return null})),ue)),Oe=Object(u.d)("",Object(le.a)({},l,(function(e,t){return t.payload}))),he=Object(be.b)({entities:je,isLoading:me,error:pe}),fe=n(61),xe=n(75),ve=n.n(xe),ge=n(76),we=n.n(ge),ye={key:"auth",storage:ve.a,whitelist:["token"]},ke=Object(fe.a)(ye,I),Ce=Object(u.a)({reducer:{contacts:he,filter:Oe,user:ke},middleware:function(e){return e().concat(we.a)},devTools:!1}),Se=Object(fe.b)(Ce),Pe=n(77);o.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(i.a,{store:Ce,children:Object(d.jsx)(Pe.a,{loading:"...",persistor:Se,children:Object(d.jsx)(J.a,{children:Object(d.jsx)(oe,{})})})})}),document.getElementById("root"))},90:function(e,t,n){},91:function(e,t,n){}},[[119,1,2]]]);
//# sourceMappingURL=main.c80ae1fc.chunk.js.map