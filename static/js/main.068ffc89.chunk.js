(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{126:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n.n(c),s=(n(97),n(98),n(163)),i=n(13),l=Object(i.b)("contacts/changeFilter"),u=(Object(i.b)("contacts/AddContactRequest"),Object(i.b)("contacts/addContactSuccess"),Object(i.b)("contacts/addContactError"),Object(i.b)("contacts/deleteContactRequest"),Object(i.b)("contacts/deleteContactSuccess"),Object(i.b)("contacts/deleteContactError"),n(10)),b=n(162),d=n(2);function j(){var e=Object(s.a)(),t=Object(u.c)();return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(b.a,{id:e,label:"Filter via name",type:"text",onChange:function(e){t(l(e.target.value))}})})}var m=n(38),h=n.n(m),O=n(59),p=n(26),f=n.n(p);f.a.defaults.baseURL="https://connections-api.herokuapp.com";var x=Object(i.c)("contacts/fetchContacts",function(){var e=Object(O.a)(h.a.mark((function e(t,n){var a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.rejectWithValue,e.prev=1,e.next=4,f.a.get("/contacts");case 4:return r=e.sent,e.abrupt("return",r.data);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),g=Object(i.c)("contacts/addContact",function(){var e=Object(O.a)(h.a.mark((function e(t,n){var a,r,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,r=t.number,c=n.rejectWithValue,e.prev=2,e.next=5,f.a.post("/contacts",{name:a,number:r});case 5:return o=e.sent,e.abrupt("return",o.data);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",c(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),v=Object(i.c)("contacts/deleteContact",function(){var e=Object(O.a)(h.a.mark((function e(t,n){var a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.rejectWithValue,e.prev=1,e.next=4,f.a.delete("contacts/".concat(t));case 4:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),w=n(37),y=n(159),k={name:"",number:""};var C=Object(u.b)(null,(function(e){return{onSubmit:function(t){return e(g(t))}}}))((function(e){var t=e.onSubmit,n=Object(a.useCallback)((function(e){var t={};return e.name?e.name.length<2&&(t.name="Invalid name\ud83d\ude22"):t.name="Required\ud83e\uddd0",e.number?(e.number.length<7||e.number.length>15)&&(t.number="Invalid value, number should have  7-15 symbols\ud83d\ude09"):t.number="Required\ud83e\uddd0",t}),[]);return Object(d.jsx)(w.b,{initialValues:k,validate:n,onSubmit:function(e,n){n.setSubmitting;var a=e.name,r=e.number;t({name:a,number:r})},children:function(e){var t=e.values,n=e.errors,a=e.touched,r=e.handleChange,c=e.handleBlur,o=e.handleSubmit,s=e.isSubmitting;return Object(d.jsxs)("form",{onSubmit:o,children:[Object(d.jsx)(b.a,{fullWidth:!0,style:{maxwidth:"350px"},id:"name",name:"name",label:"Name",type:"text",value:t.name,onChange:r,onBlur:c,error:a.name&&Boolean(n.name),helperText:a.name&&n.name}),Object(d.jsx)("br",{}),Object(d.jsx)(b.a,{fullWidth:!0,style:{maxwidth:"350px"},id:"login",name:"number",label:"Number",type:"number",value:t.number,onChange:r,onBlur:c,error:a.number&&Boolean(n.number),helperText:a.number&&n.number}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)(y.a,{variant:"contained",type:"submit",disabled:s||!(Object.keys(a).length===Object.keys(k).length&&0===Object.keys(n).length),children:"Add contact"})]})}})})),S=n(39),P=function(e){return!!e.user.token},R=Object(S.a)([function(e){return e.filter},function(e){return e.contacts.entities}],(function(e,t){if(e){var n=e.toLowerCase();return t.filter((function(e){return e.name.toLowerCase().includes(n)}))}return t})),B=n(158),E=n(160);var T=Object(u.b)(null,(function(e){return{onClick:function(t){return e(v(t))}}}))((function(e){var t=e.onClick,n=Object(u.c)();Object(a.useEffect)((function(){n(x())}),[n]);var r=Object(u.d)(R);return Object(d.jsx)(B.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},component:"nav","aria-labelledby":"nested-list-subheader",children:r.length>0&&r.map((function(e){var n=e.id,a=e.name,r=e.number;return Object(d.jsxs)(E.a,{children:[a," ",r,Object(d.jsx)(y.a,{variant:"outlined",id:n,onClick:function(e){return t(e.target.id)},children:"delete"})]},n)}))})}));function F(){return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)("h3",{children:"Phonebook"}),Object(d.jsx)(C,{}),Object(d.jsx)("br",{}),Object(d.jsx)(j,{}),Object(d.jsx)("h3",{children:"Contacts"}),Object(d.jsx)(T,{})]})}var A="/goit-react-hw-08-phonebook",W="/registration",I="/login",q="/contacts",L=n(57),N=n(23),_=n(29),U="https://connections-api.herokuapp.com",V=Object(i.e)({name:"user",initialState:{name:null,email:null,token:null,error:!1},reducers:{currentSuccess:function(e,t){var n=t.payload;e.name=n.name,e.email=n.email},currentFailure:function(e,t){var n=t.payload;e.error=n.error},registerSuccess:function(e,t){var n=t.payload;e.name=n.name,e.email=n.email,e.token=n.token},registerFailure:function(e,t){var n=t.payload;e.error=n.error},loginSuccess:function(e,t){var n=t.payload;e.name=n.name,e.email=n.email,e.token=n.token},loginFailure:function(e,t){e.error;t.payload.error},logoutSuccess:function(e,t){e.name=null,e.email=null,e.token=null},logoutFailure:function(e,t){var n=t.payload;e.error=n}}}),Z=V.actions,z=Z.currentSuccess,H=Z.currentFailure,Q=Z.registerSuccess,G=Z.registerFailure,J=Z.loginSuccess,$=Z.loginFailure,D=Z.logoutSuccess,M=Z.logoutFailure,K=V.reducer,X=function(e){f.a.defaults.headers.common.Authorization="Bearer ".concat(e)},Y=function(){f.a.defaults.headers.common.Authorization=""};function ee(){return function(e,t){var n=t().user.token;if(console.log("persist:",!!n),n)return X(n),e({type:"CURRENT_REQUEST"}),f.a.get("".concat(U,"/users/current")).then((function(t){console.log("response current:",t),e(z(t.data))})).catch((function(t){Y(),e(H(t.message))}))}}var te={name:"",email:"",passwrod:"",confirmPassword:""},ne=function(){var e=Object(u.c)(),t=Object(a.useState)(!1),n=Object(L.a)(t,2),r=n[0],c=n[1],o=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]),s=Object(a.useCallback)((function(e){var t={};return e.name?e.name.length<2&&(t.name="Invalid name\ud83d\ude22"):t.name="Required\ud83e\uddd0",e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address\ud83d\ude22"):t.email="Required\ud83e\uddd0",e.password?(e.password.length<7||e.password.length>15)&&(t.password="Invalid value, password should have  7-15 symbols\ud83d\ude09"):t.password="Required\ud83e\uddd0",e.confirmPassword?e.confirmPassword.length<7||e.confirmPassword.length>15?t.confirmPassword="Invalid value, password should have  7-15 symbols\ud83d\ude09":e.confirmPassword!==e.password&&(t.confirmPassword="Passwords do not match\ud83d\ude22"):t.confirmPassword="Required\ud83e\uddd0",t}),[]),i=Object(a.useCallback)((function(t,n){var a=n.setSubmitting;console.log(t);var r,c=t.name,o=t.email,s=t.password;e((r={name:c,email:o,password:s},console.log("user:",r),function(e){return e({type:"REGISTER_REQUEST"}),f.a.post("".concat(U,"/users/signup"),r).then((function(t){console.log("response register:",t);var n=t.data,a=n.user,r=a.name,c=a.email,o=n.token;X(o),e(Q({name:r,email:c,token:o}))})).catch((function(t){e(G(t.message))}))})),a(!1)}),[e]);return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Registration Form"}),Object(d.jsx)(w.b,{initialValues:te,validate:s,onSubmit:i,children:function(e){var t=e.isSubmitting,n=e.errors,a=e.touched,c=e.handleChange,s=e.handleBlur,i=e.values;return Object(d.jsxs)(w.a,{children:[Object(d.jsx)(b.a,{style:{maxwidth:"350px"},fullWidth:!0,id:"name",name:"name",label:"Name",type:"name",value:i.name,onChange:c,onBlur:s,error:a.name&&Boolean(n.name),helperText:a.name&&n.name}),Object(d.jsx)("br",{}),Object(d.jsx)(b.a,{style:{maxwidth:"350px"},fullWidth:!0,id:"email",name:"email",label:"Email",type:"email",value:i.email,onChange:c,onBlur:s,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(d.jsx)("br",{}),Object(d.jsx)(b.a,{style:{maxwidth:"350px"},fullWidth:!0,id:"password",name:"password",label:"Password",type:r?"text":"password",value:i.password,onChange:c,onBlur:s,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)(b.a,{style:{maxwidth:"350px"},fullWidth:!0,maxwidth:"50px",id:"confirmPassword",name:"confirmPassword",label:"Confirm Password",type:r?"text":"password",value:i.confirmPassword,onChange:c,onBlur:s,error:a.confirmPassword&&Boolean(n.confirmPassword),helperText:a.confirmPassword&&n.confirmPassword}),Object(d.jsx)(y.a,{size:"small",onClick:o,children:r?"Hide password":"Show password"}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)(y.a,{variant:"contained",type:"submit",disabled:t||!(Object.keys(a).length===Object.keys(te).length&&0===Object.keys(n).length),children:"Submit"})]})}}),Object(d.jsx)(N.b,{to:I,children:"Have an account? Login here!"})]})},ae={email:"",password:""},re=function(){var e=Object(u.c)(),t=Object(a.useState)(!1),n=Object(L.a)(t,2),r=n[0],c=n[1],o=Object(a.useCallback)((function(){c((function(e){return!e}))}),[]),s=Object(a.useCallback)((function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address\ud83d\ude22"):t.email="Required\ud83e\uddd0",e.password?(e.password.length<7||e.password.length>15)&&(t.password="Invalid value, password should have  7-15 symbols\ud83d\ude09"):t.password="Required\ud83e\uddd0",t}),[]),i=Object(a.useCallback)((function(t,n){var a,r=n.setSubmitting,c=t.email,o=t.password;e((a={email:c,password:o},function(e){return e({type:"LOGIN_REQUEST"}),f.a.post("".concat(U,"/users/login"),Object(_.a)({},a)).then((function(t){console.log("response login:",t);var n=t.data,a=n.user,r=a.name,c=a.email,o=n.token;e(J({name:r,email:c,token:o})),X(t.data.token)})).catch((function(t){e($(t.message))}))})),r(!1)}),[e]);return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Login Form"}),Object(d.jsx)(w.b,{initialValues:ae,validate:s,onSubmit:i,children:function(e){var t=e.values,n=e.errors,a=e.touched,c=e.handleChange,s=e.handleBlur,i=e.handleSubmit,l=e.isSubmitting;return Object(d.jsxs)("form",{onSubmit:i,children:[Object(d.jsx)(b.a,{fullWidth:!0,style:{maxwidth:"350px"},id:"email",name:"email",label:"Email",type:"email",value:t.email,onChange:c,onBlur:s,error:a.email&&Boolean(n.email),helperText:a.email&&n.email}),Object(d.jsx)("br",{}),Object(d.jsx)(b.a,{fullWidth:!0,style:{maxwidth:"350px"},id:"login",name:"password",label:"Password",type:r?"text":"password",value:t.password,onChange:c,onBlur:s,error:a.password&&Boolean(n.password),helperText:a.password&&n.password}),Object(d.jsx)(y.a,{size:"small",onClick:o,children:r?"Hide password":"Show password"}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)(y.a,{variant:"contained",type:"submit",disabled:l||!(Object.keys(a).length===Object.keys(ae).length&&0===Object.keys(n).length),children:"Submit"})]})}}),Object(d.jsx)("br",{}),Object(d.jsx)(N.b,{to:W,children:"Do not have account? Register here!"})]})},ce=n(14),oe=n(58),se=["component"],ie=function(e){var t=e.component,n=Object(oe.a)(e,se),a=Object(u.d)(P);return console.log("PrivateRoute:",a),Object(d.jsx)(ce.b,Object(_.a)(Object(_.a)({},n),{},{render:function(e){return a?Object(d.jsx)(t,Object(_.a)({},e)):Object(d.jsx)(ce.a,{to:W})}}))},le=["component"],ue=function(e){var t=e.component,n=Object(oe.a)(e,le),a=Object(u.d)(P);return console.log("PublicRoute:",a),Object(d.jsx)(ce.b,Object(_.a)(Object(_.a)({},n),{},{render:function(e){return a?Object(d.jsx)(ce.a,{to:A}):Object(d.jsx)(t,Object(_.a)({},e))}}))},be=n(161);function de(){return Object(d.jsx)("h1",{children:"Home"})}function je(){var e=Object(u.c)();Object(a.useEffect)((function(){console.log("APP useEffect"),e(ee())}),[e]);var t=Object(u.d)(P);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("header",{children:Object(d.jsx)("nav",{children:Object(d.jsxs)("ul",{className:"header-nav_list",children:[Object(d.jsx)("li",{children:Object(d.jsx)(N.c,{to:A,children:"Home"})}),Object(d.jsx)("li",{children:Object(d.jsx)(N.c,{to:q,children:"Contacts"})}),Object(d.jsx)("li",{children:t?Object(d.jsx)(y.a,{type:"button",onClick:function(){e((function(e){return e({type:"LOGOUT_REQUEST"}),f.a.post("".concat(U,"/users/logout")).then((function(t){Y(),e(D(t.data))})).catch((function(t){e(M(t.message))}))}))},children:"logout"}):Object(d.jsxs)("ul",{className:"header-nav_list",children:[Object(d.jsx)("li",{children:Object(d.jsx)(N.c,{to:I,children:"Login"})}),Object(d.jsx)("li",{children:Object(d.jsx)(N.c,{to:W,children:"Registration"})})]})})]})})}),Object(d.jsx)(be.a,{maxWidth:"sm",className:"Container",children:Object(d.jsx)(a.Suspense,{fallback:Object(d.jsx)("div",{children:"Loading..."}),children:Object(d.jsxs)(ce.d,{children:[Object(d.jsx)(ie,{component:F,path:q,exact:!0}),Object(d.jsx)(ue,{path:A,exact:!0,component:de}),Object(d.jsx)(ue,{path:W,exact:!0,component:ne}),Object(d.jsx)(ue,{path:I,exact:!0,component:re})]})})})]})}console.log(ee);var me,he,Oe,pe=n(56),fe=n(20),xe=n(18),ge=Object(i.d)([],(me={},Object(fe.a)(me,x.fulfilled,(function(e,t){return t.payload})),Object(fe.a)(me,g.fulfilled,(function(e,t){var n=t.payload;return[].concat(Object(pe.a)(e),[n])})),Object(fe.a)(me,v.fulfilled,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),me)),ve=Object(i.d)(!1,(he={},Object(fe.a)(he,x.pending,(function(){return!0})),Object(fe.a)(he,x.fulfilled,(function(){return!1})),Object(fe.a)(he,x.rejected,(function(){return!1})),Object(fe.a)(he,g.pending,(function(){return!0})),Object(fe.a)(he,g.fulfilled,(function(){return!1})),Object(fe.a)(he,g.rejected,(function(){return!1})),he)),we=Object(i.d)(null,(Oe={},Object(fe.a)(Oe,x.rejected,(function(e,t){return t.payload})),Object(fe.a)(Oe,x.pending,(function(){return null})),Oe)),ye=Object(i.d)("",Object(fe.a)({},l,(function(e,t){return t.payload}))),ke=Object(xe.b)({entities:ge,isLoading:ve,error:we}),Ce=n(32),Se=n(84),Pe={key:"auth",storage:n.n(Se).a,whitelist:["token"]},Re=Object(Ce.g)(Pe,K),Be=Object(pe.a)(Object(i.f)({serializableCheck:{ignoredActions:[Ce.a,Ce.f,Ce.b,Ce.c,Ce.d,Ce.e]}})),Ee=Object(i.a)({reducer:{contacts:ke,filter:ye,user:Re},middleware:Be,devTools:!1}),Te=Object(Ce.h)(Ee),Fe=n(85);o.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(u.a,{store:Ee,children:Object(d.jsx)(Fe.a,{loading:"...",persistor:Te,children:Object(d.jsx)(N.a,{children:Object(d.jsx)(je,{})})})})}),document.getElementById("root"))},97:function(e,t,n){},98:function(e,t,n){}},[[126,1,2]]]);
//# sourceMappingURL=main.068ffc89.chunk.js.map